{"ast":null,"code":"import { _ as _objectWithoutPropertiesLoose, a as _objectSpread2 } from '../_rollupPluginBabelHelpers-1f0bf8c2.js';\nimport { useReducer, useCallback, useEffect } from 'react';\nimport { useLiveRef } from 'reakit-utils/useLiveRef';\nimport { useSealedState } from 'reakit-utils/useSealedState';\nimport { useUpdateEffect } from 'reakit-utils/useUpdateEffect';\nimport '../Id/IdProvider.js';\nimport { unstable_useIdState } from '../Id/IdState.js';\nimport { isEmpty } from 'reakit-utils/isEmpty';\nimport { unstable_getIn } from './utils/getIn.js';\nimport { isPromise } from 'reakit-utils/isPromise';\nimport { isPlainObject } from 'reakit-utils/isPlainObject';\nimport { isObject } from 'reakit-utils/isObject';\nimport { unstable_setAllIn } from './utils/setAllIn.js';\nimport 'reakit-utils/toArray';\nimport 'reakit-utils/isInteger';\nimport { unstable_setIn } from './utils/setIn.js';\n\nfunction filterAllEmpty(object) {\n  if (Array.isArray(object)) {\n    return object.filter(function (value) {\n      if (isPlainObject(value) || Array.isArray(value)) {\n        return filterAllEmpty(value);\n      }\n\n      return true;\n    });\n  }\n\n  var result = {};\n  var keys = Object.keys(object);\n\n  for (var _i = 0, _keys = keys; _i < _keys.length; _i++) {\n    var key = _keys[_i];\n    var k = key;\n    var value = object[k];\n    result[k] = isPlainObject(value) || Array.isArray(value) ? filterAllEmpty(value) : object[k];\n  }\n\n  return result;\n}\n\nfunction hasMessages(errors) {\n  return isObject(errors) && !isEmpty(errors);\n}\n\nfunction getMessages(stateMessages, actionMessages) {\n  return !isEmpty(actionMessages) ? actionMessages : isEmpty(stateMessages) ? stateMessages : {};\n}\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case \"reset\":\n      {\n        return _objectSpread2(_objectSpread2({}, state), {}, {\n          values: state.initialValues,\n          touched: {},\n          errors: {},\n          messages: {},\n          valid: true,\n          validating: false,\n          submitting: false,\n          submitFailed: 0,\n          submitSucceed: 0\n        });\n      }\n\n    case \"startValidate\":\n      {\n        return _objectSpread2(_objectSpread2({}, state), {}, {\n          validating: true\n        });\n      }\n\n    case \"endValidate\":\n      {\n        return _objectSpread2(_objectSpread2({}, state), {}, {\n          validating: false,\n          errors: getMessages(state.errors, action.errors),\n          messages: getMessages(state.messages, action.messages),\n          valid: !hasMessages(action.errors)\n        });\n      }\n\n    case \"startSubmit\":\n      {\n        return _objectSpread2(_objectSpread2({}, state), {}, {\n          // @ts-ignore TS bug\n          touched: unstable_setAllIn(state.values, true),\n          submitting: true\n        });\n      }\n\n    case \"endSubmit\":\n      {\n        var valid = !hasMessages(action.errors);\n        return _objectSpread2(_objectSpread2({}, state), {}, {\n          valid: valid,\n          submitting: false,\n          errors: getMessages(state.errors, action.errors),\n          messages: getMessages(state.messages, action.messages),\n          submitSucceed: valid ? state.submitSucceed + 1 : state.submitSucceed,\n          submitFailed: valid ? state.submitFailed : state.submitFailed + 1\n        });\n      }\n\n    case \"update\":\n      {\n        var _name = action.name,\n            _value = action.value;\n        var nextValue = typeof _value === \"function\" ? _value(unstable_getIn(state.values, _name)) : _value;\n        return _objectSpread2(_objectSpread2({}, state), {}, {\n          values: unstable_setIn(state.values, _name, nextValue != null ? nextValue : \"\")\n        });\n      }\n\n    case \"blur\":\n      {\n        return _objectSpread2(_objectSpread2({}, state), {}, {\n          touched: unstable_setIn(state.touched, action.name, true)\n        });\n      }\n\n    case \"push\":\n      {\n        var array = unstable_getIn(state.values, action.name, []);\n        return _objectSpread2(_objectSpread2({}, state), {}, {\n          values: unstable_setIn(state.values, action.name, [].concat(array, [action.value]))\n        });\n      }\n\n    case \"remove\":\n      {\n        var _array = unstable_getIn(state.values, action.name, []).slice();\n\n        delete _array[action.index];\n        return _objectSpread2(_objectSpread2({}, state), {}, {\n          values: unstable_setIn(state.values, action.name, _array)\n        });\n      }\n\n    default:\n      {\n        throw new Error();\n      }\n  }\n}\n\nfunction unstable_useFormState(initialState) {\n  if (initialState === void 0) {\n    initialState = {};\n  }\n\n  var _useSealedState = useSealedState(initialState),\n      _useSealedState$value = _useSealedState.values,\n      initialValues = _useSealedState$value === void 0 ? {} : _useSealedState$value,\n      _useSealedState$valid = _useSealedState.validateOnBlur,\n      validateOnBlur = _useSealedState$valid === void 0 ? true : _useSealedState$valid,\n      _useSealedState$valid2 = _useSealedState.validateOnChange,\n      validateOnChange = _useSealedState$valid2 === void 0 ? true : _useSealedState$valid2,\n      _useSealedState$reset = _useSealedState.resetOnSubmitSucceed,\n      resetOnSubmitSucceed = _useSealedState$reset === void 0 ? false : _useSealedState$reset,\n      _useSealedState$reset2 = _useSealedState.resetOnUnmount,\n      resetOnUnmount = _useSealedState$reset2 === void 0 ? true : _useSealedState$reset2,\n      onValidate = _useSealedState.onValidate,\n      onSubmit = _useSealedState.onSubmit,\n      sealed = _objectWithoutPropertiesLoose(_useSealedState, [\"values\", \"validateOnBlur\", \"validateOnChange\", \"resetOnSubmitSucceed\", \"resetOnUnmount\", \"onValidate\", \"onSubmit\"]);\n\n  var onValidateRef = useLiveRef(typeof initialState !== \"function\" ? initialState.onValidate : onValidate);\n  var onSubmitRef = useLiveRef(typeof initialState !== \"function\" ? initialState.onSubmit : onSubmit);\n  var id = unstable_useIdState(sealed);\n\n  var _React$useReducer = useReducer(reducer, {\n    initialValues: initialValues,\n    values: initialValues,\n    touched: {},\n    errors: {},\n    messages: {},\n    valid: true,\n    validating: false,\n    submitting: false,\n    submitFailed: 0,\n    submitSucceed: 0\n  }),\n      _React$useReducer$ = _React$useReducer[0],\n      _ = _React$useReducer$.initialValues,\n      state = _objectWithoutPropertiesLoose(_React$useReducer$, [\"initialValues\"]),\n      dispatch = _React$useReducer[1];\n\n  var validate = useCallback(function (vals) {\n    if (vals === void 0) {\n      vals = state.values;\n    }\n\n    return new Promise(function (resolve) {\n      if (onValidateRef.current) {\n        var response = onValidateRef.current(vals);\n\n        if (isPromise(response)) {\n          dispatch({\n            type: \"startValidate\"\n          });\n        }\n\n        resolve(Promise.resolve(response).then(function (messages) {\n          dispatch({\n            type: \"endValidate\",\n            messages: messages\n          });\n          return messages;\n        }));\n      } else {\n        resolve(undefined);\n      }\n    }).catch(function (errors) {\n      dispatch({\n        type: \"endValidate\",\n        errors: errors\n      });\n      throw errors;\n    });\n  }, [state.values]);\n  useUpdateEffect(function () {\n    if (validateOnChange) {\n      validate().catch(function () {});\n    }\n  }, [validate, validateOnChange]);\n  useEffect(function () {\n    if (resetOnUnmount) {\n      return function () {\n        dispatch({\n          type: \"reset\"\n        });\n      };\n    }\n\n    return undefined;\n  }, [resetOnUnmount]);\n  return _objectSpread2(_objectSpread2(_objectSpread2({}, id), state), {}, {\n    values: state.values,\n    validate: validate,\n    reset: useCallback(function () {\n      return dispatch({\n        type: \"reset\"\n      });\n    }, []),\n    submit: useCallback(function () {\n      dispatch({\n        type: \"startSubmit\"\n      });\n      return validate().then(function (validateMessages) {\n        if (onSubmitRef.current) {\n          return Promise.resolve(onSubmitRef.current(filterAllEmpty(state.values))).then(function (submitMessages) {\n            var messages = _objectSpread2(_objectSpread2({}, validateMessages), submitMessages);\n\n            dispatch({\n              type: \"endSubmit\",\n              messages: messages\n            });\n          });\n        }\n\n        return dispatch({\n          type: \"endSubmit\",\n          messages: validateMessages\n        });\n      }).then(function () {\n        if (resetOnSubmitSucceed) {\n          dispatch({\n            type: \"reset\"\n          });\n        }\n      }).catch(function (errors) {\n        dispatch({\n          type: \"endSubmit\",\n          errors: errors\n        });\n      });\n    }, [validate]),\n    update: useCallback(function (name, value) {\n      return dispatch({\n        type: \"update\",\n        name: name,\n        value: value\n      });\n    }, []),\n    blur: useCallback(function (name) {\n      dispatch({\n        type: \"blur\",\n        name: name\n      });\n\n      if (validateOnBlur) {\n        validate().catch(function () {});\n      }\n    }, [validate]),\n    push: useCallback(function (name, value) {\n      return dispatch({\n        type: \"push\",\n        name: name,\n        value: value\n      });\n    }, []),\n    remove: useCallback(function (name, index) {\n      return dispatch({\n        type: \"remove\",\n        name: name,\n        index: index\n      });\n    }, [])\n  });\n}\n\nexport { unstable_useFormState };","map":{"version":3,"sources":["/Users/davimello/Creative Cloud Files/Davi/code/portfolio-react/node_modules/reakit/es/Form/FormState.js"],"names":["_","_objectWithoutPropertiesLoose","a","_objectSpread2","useReducer","useCallback","useEffect","useLiveRef","useSealedState","useUpdateEffect","unstable_useIdState","isEmpty","unstable_getIn","isPromise","isPlainObject","isObject","unstable_setAllIn","unstable_setIn","filterAllEmpty","object","Array","isArray","filter","value","result","keys","Object","_i","_keys","length","key","k","hasMessages","errors","getMessages","stateMessages","actionMessages","reducer","state","action","type","values","initialValues","touched","messages","valid","validating","submitting","submitFailed","submitSucceed","_name","name","_value","nextValue","array","concat","_array","slice","index","Error","unstable_useFormState","initialState","_useSealedState","_useSealedState$value","_useSealedState$valid","validateOnBlur","_useSealedState$valid2","validateOnChange","_useSealedState$reset","resetOnSubmitSucceed","_useSealedState$reset2","resetOnUnmount","onValidate","onSubmit","sealed","onValidateRef","onSubmitRef","id","_React$useReducer","_React$useReducer$","dispatch","validate","vals","Promise","resolve","current","response","then","undefined","catch","reset","submit","validateMessages","submitMessages","update","blur","push","remove"],"mappings":"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","sourcesContent":["import { _ as _objectWithoutPropertiesLoose, a as _objectSpread2 } from '../_rollupPluginBabelHelpers-1f0bf8c2.js';\nimport { useReducer, useCallback, useEffect } from 'react';\nimport { useLiveRef } from 'reakit-utils/useLiveRef';\nimport { useSealedState } from 'reakit-utils/useSealedState';\nimport { useUpdateEffect } from 'reakit-utils/useUpdateEffect';\nimport '../Id/IdProvider.js';\nimport { unstable_useIdState } from '../Id/IdState.js';\nimport { isEmpty } from 'reakit-utils/isEmpty';\nimport { unstable_getIn } from './utils/getIn.js';\nimport { isPromise } from 'reakit-utils/isPromise';\nimport { isPlainObject } from 'reakit-utils/isPlainObject';\nimport { isObject } from 'reakit-utils/isObject';\nimport { unstable_setAllIn } from './utils/setAllIn.js';\nimport 'reakit-utils/toArray';\nimport 'reakit-utils/isInteger';\nimport { unstable_setIn } from './utils/setIn.js';\n\nfunction filterAllEmpty(object) {\n  if (Array.isArray(object)) {\n    return object.filter(function (value) {\n      if (isPlainObject(value) || Array.isArray(value)) {\n        return filterAllEmpty(value);\n      }\n\n      return true;\n    });\n  }\n\n  var result = {};\n  var keys = Object.keys(object);\n\n  for (var _i = 0, _keys = keys; _i < _keys.length; _i++) {\n    var key = _keys[_i];\n    var k = key;\n    var value = object[k];\n    result[k] = isPlainObject(value) || Array.isArray(value) ? filterAllEmpty(value) : object[k];\n  }\n\n  return result;\n}\n\nfunction hasMessages(errors) {\n  return isObject(errors) && !isEmpty(errors);\n}\n\nfunction getMessages(stateMessages, actionMessages) {\n  return !isEmpty(actionMessages) ? actionMessages : isEmpty(stateMessages) ? stateMessages : {};\n}\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case \"reset\":\n      {\n        return _objectSpread2(_objectSpread2({}, state), {}, {\n          values: state.initialValues,\n          touched: {},\n          errors: {},\n          messages: {},\n          valid: true,\n          validating: false,\n          submitting: false,\n          submitFailed: 0,\n          submitSucceed: 0\n        });\n      }\n\n    case \"startValidate\":\n      {\n        return _objectSpread2(_objectSpread2({}, state), {}, {\n          validating: true\n        });\n      }\n\n    case \"endValidate\":\n      {\n        return _objectSpread2(_objectSpread2({}, state), {}, {\n          validating: false,\n          errors: getMessages(state.errors, action.errors),\n          messages: getMessages(state.messages, action.messages),\n          valid: !hasMessages(action.errors)\n        });\n      }\n\n    case \"startSubmit\":\n      {\n        return _objectSpread2(_objectSpread2({}, state), {}, {\n          // @ts-ignore TS bug\n          touched: unstable_setAllIn(state.values, true),\n          submitting: true\n        });\n      }\n\n    case \"endSubmit\":\n      {\n        var valid = !hasMessages(action.errors);\n        return _objectSpread2(_objectSpread2({}, state), {}, {\n          valid: valid,\n          submitting: false,\n          errors: getMessages(state.errors, action.errors),\n          messages: getMessages(state.messages, action.messages),\n          submitSucceed: valid ? state.submitSucceed + 1 : state.submitSucceed,\n          submitFailed: valid ? state.submitFailed : state.submitFailed + 1\n        });\n      }\n\n    case \"update\":\n      {\n        var _name = action.name,\n            _value = action.value;\n        var nextValue = typeof _value === \"function\" ? _value(unstable_getIn(state.values, _name)) : _value;\n        return _objectSpread2(_objectSpread2({}, state), {}, {\n          values: unstable_setIn(state.values, _name, nextValue != null ? nextValue : \"\")\n        });\n      }\n\n    case \"blur\":\n      {\n        return _objectSpread2(_objectSpread2({}, state), {}, {\n          touched: unstable_setIn(state.touched, action.name, true)\n        });\n      }\n\n    case \"push\":\n      {\n        var array = unstable_getIn(state.values, action.name, []);\n        return _objectSpread2(_objectSpread2({}, state), {}, {\n          values: unstable_setIn(state.values, action.name, [].concat(array, [action.value]))\n        });\n      }\n\n    case \"remove\":\n      {\n        var _array = unstable_getIn(state.values, action.name, []).slice();\n\n        delete _array[action.index];\n        return _objectSpread2(_objectSpread2({}, state), {}, {\n          values: unstable_setIn(state.values, action.name, _array)\n        });\n      }\n\n    default:\n      {\n        throw new Error();\n      }\n  }\n}\n\nfunction unstable_useFormState(initialState) {\n  if (initialState === void 0) {\n    initialState = {};\n  }\n\n  var _useSealedState = useSealedState(initialState),\n      _useSealedState$value = _useSealedState.values,\n      initialValues = _useSealedState$value === void 0 ? {} : _useSealedState$value,\n      _useSealedState$valid = _useSealedState.validateOnBlur,\n      validateOnBlur = _useSealedState$valid === void 0 ? true : _useSealedState$valid,\n      _useSealedState$valid2 = _useSealedState.validateOnChange,\n      validateOnChange = _useSealedState$valid2 === void 0 ? true : _useSealedState$valid2,\n      _useSealedState$reset = _useSealedState.resetOnSubmitSucceed,\n      resetOnSubmitSucceed = _useSealedState$reset === void 0 ? false : _useSealedState$reset,\n      _useSealedState$reset2 = _useSealedState.resetOnUnmount,\n      resetOnUnmount = _useSealedState$reset2 === void 0 ? true : _useSealedState$reset2,\n      onValidate = _useSealedState.onValidate,\n      onSubmit = _useSealedState.onSubmit,\n      sealed = _objectWithoutPropertiesLoose(_useSealedState, [\"values\", \"validateOnBlur\", \"validateOnChange\", \"resetOnSubmitSucceed\", \"resetOnUnmount\", \"onValidate\", \"onSubmit\"]);\n\n  var onValidateRef = useLiveRef(typeof initialState !== \"function\" ? initialState.onValidate : onValidate);\n  var onSubmitRef = useLiveRef(typeof initialState !== \"function\" ? initialState.onSubmit : onSubmit);\n  var id = unstable_useIdState(sealed);\n\n  var _React$useReducer = useReducer(reducer, {\n    initialValues: initialValues,\n    values: initialValues,\n    touched: {},\n    errors: {},\n    messages: {},\n    valid: true,\n    validating: false,\n    submitting: false,\n    submitFailed: 0,\n    submitSucceed: 0\n  }),\n      _React$useReducer$ = _React$useReducer[0],\n      _ = _React$useReducer$.initialValues,\n      state = _objectWithoutPropertiesLoose(_React$useReducer$, [\"initialValues\"]),\n      dispatch = _React$useReducer[1];\n\n  var validate = useCallback(function (vals) {\n    if (vals === void 0) {\n      vals = state.values;\n    }\n\n    return new Promise(function (resolve) {\n      if (onValidateRef.current) {\n        var response = onValidateRef.current(vals);\n\n        if (isPromise(response)) {\n          dispatch({\n            type: \"startValidate\"\n          });\n        }\n\n        resolve(Promise.resolve(response).then(function (messages) {\n          dispatch({\n            type: \"endValidate\",\n            messages: messages\n          });\n          return messages;\n        }));\n      } else {\n        resolve(undefined);\n      }\n    }).catch(function (errors) {\n      dispatch({\n        type: \"endValidate\",\n        errors: errors\n      });\n      throw errors;\n    });\n  }, [state.values]);\n  useUpdateEffect(function () {\n    if (validateOnChange) {\n      validate().catch(function () {});\n    }\n  }, [validate, validateOnChange]);\n  useEffect(function () {\n    if (resetOnUnmount) {\n      return function () {\n        dispatch({\n          type: \"reset\"\n        });\n      };\n    }\n\n    return undefined;\n  }, [resetOnUnmount]);\n  return _objectSpread2(_objectSpread2(_objectSpread2({}, id), state), {}, {\n    values: state.values,\n    validate: validate,\n    reset: useCallback(function () {\n      return dispatch({\n        type: \"reset\"\n      });\n    }, []),\n    submit: useCallback(function () {\n      dispatch({\n        type: \"startSubmit\"\n      });\n      return validate().then(function (validateMessages) {\n        if (onSubmitRef.current) {\n          return Promise.resolve(onSubmitRef.current(filterAllEmpty(state.values))).then(function (submitMessages) {\n            var messages = _objectSpread2(_objectSpread2({}, validateMessages), submitMessages);\n\n            dispatch({\n              type: \"endSubmit\",\n              messages: messages\n            });\n          });\n        }\n\n        return dispatch({\n          type: \"endSubmit\",\n          messages: validateMessages\n        });\n      }).then(function () {\n        if (resetOnSubmitSucceed) {\n          dispatch({\n            type: \"reset\"\n          });\n        }\n      }).catch(function (errors) {\n        dispatch({\n          type: \"endSubmit\",\n          errors: errors\n        });\n      });\n    }, [validate]),\n    update: useCallback(function (name, value) {\n      return dispatch({\n        type: \"update\",\n        name: name,\n        value: value\n      });\n    }, []),\n    blur: useCallback(function (name) {\n      dispatch({\n        type: \"blur\",\n        name: name\n      });\n\n      if (validateOnBlur) {\n        validate().catch(function () {});\n      }\n    }, [validate]),\n    push: useCallback(function (name, value) {\n      return dispatch({\n        type: \"push\",\n        name: name,\n        value: value\n      });\n    }, []),\n    remove: useCallback(function (name, index) {\n      return dispatch({\n        type: \"remove\",\n        name: name,\n        index: index\n      });\n    }, [])\n  });\n}\n\nexport { unstable_useFormState };\n"]},"metadata":{},"sourceType":"module"}